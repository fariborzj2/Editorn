var Xt=Object.defineProperty;var Vt=(c,e,t)=>e in c?Xt(c,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):c[e]=t;var a=(c,e,t)=>Vt(c,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();class jt{constructor(){a(this,"events",new Map)}on(e,t){var i;this.events.has(e)||this.events.set(e,[]),(i=this.events.get(e))==null||i.push(t)}off(e,t){const i=this.events.get(e);i&&this.events.set(e,i.filter(s=>s!==t))}emit(e,t){const i=this.events.get(e);i&&i.forEach(s=>s(t))}}class Jt{constructor(e){a(this,"plugins",new Map);a(this,"editor");this.editor=e}register(e){if(this.plugins.has(e.name)){console.warn(`Plugin ${e.name} is already registered.`);return}this.plugins.set(e.name,e),e.init(this.editor)}unregister(e){const t=this.plugins.get(e);t&&(t.destroy&&t.destroy(),this.plugins.delete(e))}get(e){return this.plugins.get(e)}}/*! @license DOMPurify 3.3.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.0/LICENSE */const{entries:_t,setPrototypeOf:pt,isFrozen:Zt,getPrototypeOf:Qt,getOwnPropertyDescriptor:ei}=Object;let{freeze:w,seal:R,create:Fe}=Object,{apply:qe,construct:ze}=typeof Reflect<"u"&&Reflect;w||(w=function(e){return e});R||(R=function(e){return e});qe||(qe=function(e,t){for(var i=arguments.length,s=new Array(i>2?i-2:0),o=2;o<i;o++)s[o-2]=arguments[o];return e.apply(t,s)});ze||(ze=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];return new e(...i)});const ge=C(Array.prototype.forEach),ti=C(Array.prototype.lastIndexOf),ft=C(Array.prototype.pop),ie=C(Array.prototype.push),ii=C(Array.prototype.splice),Ee=C(String.prototype.toLowerCase),Oe=C(String.prototype.toString),Ne=C(String.prototype.match),ne=C(String.prototype.replace),ni=C(String.prototype.indexOf),si=C(String.prototype.trim),D=C(Object.prototype.hasOwnProperty),M=C(RegExp.prototype.test),se=oi(TypeError);function C(c){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,i=new Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];return qe(c,e,i)}}function oi(c){return function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return ze(c,t)}}function m(c,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ee;pt&&pt(c,null);let i=e.length;for(;i--;){let s=e[i];if(typeof s=="string"){const o=t(s);o!==s&&(Zt(e)||(e[i]=o),s=o)}c[s]=!0}return c}function ai(c){for(let e=0;e<c.length;e++)D(c,e)||(c[e]=null);return c}function U(c){const e=Fe(null);for(const[t,i]of _t(c))D(c,t)&&(Array.isArray(i)?e[t]=ai(i):i&&typeof i=="object"&&i.constructor===Object?e[t]=U(i):e[t]=i);return e}function oe(c,e){for(;c!==null;){const i=ei(c,e);if(i){if(i.get)return C(i.get);if(typeof i.value=="function")return C(i.value)}c=Qt(c)}function t(){return null}return t}const gt=w(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Be=w(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Pe=w(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),ri=w(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Ue=w(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),li=w(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),bt=w(["#text"]),Et=w(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),He=w(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),yt=w(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),be=w(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),ci=R(/\{\{[\w\W]*|[\w\W]*\}\}/gm),di=R(/<%[\w\W]*|[\w\W]*%>/gm),hi=R(/\$\{[\w\W]*/gm),ui=R(/^data-[\-\w.\u00B7-\uFFFF]+$/),mi=R(/^aria-[\-\w]+$/),At=R(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),pi=R(/^(?:\w+script|data):/i),fi=R(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),St=R(/^html$/i),gi=R(/^[a-z][.\w]*(-[.\w]+)+$/i);var vt=Object.freeze({__proto__:null,ARIA_ATTR:mi,ATTR_WHITESPACE:fi,CUSTOM_ELEMENT:gi,DATA_ATTR:ui,DOCTYPE_NAME:St,ERB_EXPR:di,IS_ALLOWED_URI:At,IS_SCRIPT_OR_DATA:pi,MUSTACHE_EXPR:ci,TMPLIT_EXPR:hi});const ae={element:1,text:3,progressingInstruction:7,comment:8,document:9},bi=function(){return typeof window>"u"?null:window},Ei=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let i=null;const s="data-tt-policy-suffix";t&&t.hasAttribute(s)&&(i=t.getAttribute(s));const o="dompurify"+(i?"#"+i:"");try{return e.createPolicy(o,{createHTML(l){return l},createScriptURL(l){return l}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},Tt=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Mt(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:bi();const e=h=>Mt(h);if(e.version="3.3.0",e.removed=[],!c||!c.document||c.document.nodeType!==ae.document||!c.Element)return e.isSupported=!1,e;let{document:t}=c;const i=t,s=i.currentScript,{DocumentFragment:o,HTMLTemplateElement:l,Node:u,Element:p,NodeFilter:g,NamedNodeMap:T=c.NamedNodeMap||c.MozNamedAttrMap,HTMLFormElement:x,DOMParser:j,trustedTypes:q}=c,J=p.prototype,wt=oe(J,"cloneNode"),Ct=oe(J,"remove"),It=oe(J,"nextSibling"),xt=oe(J,"childNodes"),le=oe(J,"parentNode");if(typeof l=="function"){const h=t.createElement("template");h.content&&h.content.ownerDocument&&(t=h.content.ownerDocument)}let A,Z="";const{implementation:ye,createNodeIterator:Rt,createDocumentFragment:Dt,getElementsByTagName:Ot}=t,{importNode:Nt}=i;let S=Tt();e.isSupported=typeof _t=="function"&&typeof le=="function"&&ye&&ye.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:ve,ERB_EXPR:Te,TMPLIT_EXPR:ke,DATA_ATTR:Bt,ARIA_ATTR:Pt,IS_SCRIPT_OR_DATA:Ut,ATTR_WHITESPACE:We,CUSTOM_ELEMENT:Ht}=vt;let{IS_ALLOWED_URI:$e}=vt,y=null;const Ge=m({},[...gt,...Be,...Pe,...Ue,...bt]);let k=null;const Ye=m({},[...Et,...He,...yt,...be]);let b=Object.seal(Fe(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Q=null,Le=null;const z=Object.seal(Fe(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let Ke=!0,_e=!0,Xe=!1,Ve=!0,W=!1,ce=!0,H=!1,Ae=!1,Se=!1,$=!1,de=!1,he=!1,je=!0,Je=!1;const Ft="user-content-";let Me=!0,ee=!1,G={},Y=null;const Ze=m({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Qe=null;const et=m({},["audio","video","img","source","image","track"]);let we=null;const tt=m({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ue="http://www.w3.org/1998/Math/MathML",me="http://www.w3.org/2000/svg",N="http://www.w3.org/1999/xhtml";let K=N,Ce=!1,Ie=null;const qt=m({},[ue,me,N],Oe);let pe=m({},["mi","mo","mn","ms","mtext"]),fe=m({},["annotation-xml"]);const zt=m({},["title","style","font","a","script"]);let te=null;const Wt=["application/xhtml+xml","text/html"],$t="text/html";let v=null,X=null;const Gt=t.createElement("form"),it=function(n){return n instanceof RegExp||n instanceof Function},xe=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(X&&X===n)){if((!n||typeof n!="object")&&(n={}),n=U(n),te=Wt.indexOf(n.PARSER_MEDIA_TYPE)===-1?$t:n.PARSER_MEDIA_TYPE,v=te==="application/xhtml+xml"?Oe:Ee,y=D(n,"ALLOWED_TAGS")?m({},n.ALLOWED_TAGS,v):Ge,k=D(n,"ALLOWED_ATTR")?m({},n.ALLOWED_ATTR,v):Ye,Ie=D(n,"ALLOWED_NAMESPACES")?m({},n.ALLOWED_NAMESPACES,Oe):qt,we=D(n,"ADD_URI_SAFE_ATTR")?m(U(tt),n.ADD_URI_SAFE_ATTR,v):tt,Qe=D(n,"ADD_DATA_URI_TAGS")?m(U(et),n.ADD_DATA_URI_TAGS,v):et,Y=D(n,"FORBID_CONTENTS")?m({},n.FORBID_CONTENTS,v):Ze,Q=D(n,"FORBID_TAGS")?m({},n.FORBID_TAGS,v):U({}),Le=D(n,"FORBID_ATTR")?m({},n.FORBID_ATTR,v):U({}),G=D(n,"USE_PROFILES")?n.USE_PROFILES:!1,Ke=n.ALLOW_ARIA_ATTR!==!1,_e=n.ALLOW_DATA_ATTR!==!1,Xe=n.ALLOW_UNKNOWN_PROTOCOLS||!1,Ve=n.ALLOW_SELF_CLOSE_IN_ATTR!==!1,W=n.SAFE_FOR_TEMPLATES||!1,ce=n.SAFE_FOR_XML!==!1,H=n.WHOLE_DOCUMENT||!1,$=n.RETURN_DOM||!1,de=n.RETURN_DOM_FRAGMENT||!1,he=n.RETURN_TRUSTED_TYPE||!1,Se=n.FORCE_BODY||!1,je=n.SANITIZE_DOM!==!1,Je=n.SANITIZE_NAMED_PROPS||!1,Me=n.KEEP_CONTENT!==!1,ee=n.IN_PLACE||!1,$e=n.ALLOWED_URI_REGEXP||At,K=n.NAMESPACE||N,pe=n.MATHML_TEXT_INTEGRATION_POINTS||pe,fe=n.HTML_INTEGRATION_POINTS||fe,b=n.CUSTOM_ELEMENT_HANDLING||{},n.CUSTOM_ELEMENT_HANDLING&&it(n.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(b.tagNameCheck=n.CUSTOM_ELEMENT_HANDLING.tagNameCheck),n.CUSTOM_ELEMENT_HANDLING&&it(n.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(b.attributeNameCheck=n.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),n.CUSTOM_ELEMENT_HANDLING&&typeof n.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(b.allowCustomizedBuiltInElements=n.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),W&&(_e=!1),de&&($=!0),G&&(y=m({},bt),k=[],G.html===!0&&(m(y,gt),m(k,Et)),G.svg===!0&&(m(y,Be),m(k,He),m(k,be)),G.svgFilters===!0&&(m(y,Pe),m(k,He),m(k,be)),G.mathMl===!0&&(m(y,Ue),m(k,yt),m(k,be))),n.ADD_TAGS&&(typeof n.ADD_TAGS=="function"?z.tagCheck=n.ADD_TAGS:(y===Ge&&(y=U(y)),m(y,n.ADD_TAGS,v))),n.ADD_ATTR&&(typeof n.ADD_ATTR=="function"?z.attributeCheck=n.ADD_ATTR:(k===Ye&&(k=U(k)),m(k,n.ADD_ATTR,v))),n.ADD_URI_SAFE_ATTR&&m(we,n.ADD_URI_SAFE_ATTR,v),n.FORBID_CONTENTS&&(Y===Ze&&(Y=U(Y)),m(Y,n.FORBID_CONTENTS,v)),Me&&(y["#text"]=!0),H&&m(y,["html","head","body"]),y.table&&(m(y,["tbody"]),delete Q.tbody),n.TRUSTED_TYPES_POLICY){if(typeof n.TRUSTED_TYPES_POLICY.createHTML!="function")throw se('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof n.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw se('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');A=n.TRUSTED_TYPES_POLICY,Z=A.createHTML("")}else A===void 0&&(A=Ei(q,s)),A!==null&&typeof Z=="string"&&(Z=A.createHTML(""));w&&w(n),X=n}},nt=m({},[...Be,...Pe,...ri]),st=m({},[...Ue,...li]),Yt=function(n){let r=le(n);(!r||!r.tagName)&&(r={namespaceURI:K,tagName:"template"});const d=Ee(n.tagName),f=Ee(r.tagName);return Ie[n.namespaceURI]?n.namespaceURI===me?r.namespaceURI===N?d==="svg":r.namespaceURI===ue?d==="svg"&&(f==="annotation-xml"||pe[f]):!!nt[d]:n.namespaceURI===ue?r.namespaceURI===N?d==="math":r.namespaceURI===me?d==="math"&&fe[f]:!!st[d]:n.namespaceURI===N?r.namespaceURI===me&&!fe[f]||r.namespaceURI===ue&&!pe[f]?!1:!st[d]&&(zt[d]||!nt[d]):!!(te==="application/xhtml+xml"&&Ie[n.namespaceURI]):!1},O=function(n){ie(e.removed,{element:n});try{le(n).removeChild(n)}catch{Ct(n)}},F=function(n,r){try{ie(e.removed,{attribute:r.getAttributeNode(n),from:r})}catch{ie(e.removed,{attribute:null,from:r})}if(r.removeAttribute(n),n==="is")if($||de)try{O(r)}catch{}else try{r.setAttribute(n,"")}catch{}},ot=function(n){let r=null,d=null;if(Se)n="<remove></remove>"+n;else{const E=Ne(n,/^[\r\n\t ]+/);d=E&&E[0]}te==="application/xhtml+xml"&&K===N&&(n='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+n+"</body></html>");const f=A?A.createHTML(n):n;if(K===N)try{r=new j().parseFromString(f,te)}catch{}if(!r||!r.documentElement){r=ye.createDocument(K,"template",null);try{r.documentElement.innerHTML=Ce?Z:f}catch{}}const _=r.body||r.documentElement;return n&&d&&_.insertBefore(t.createTextNode(d),_.childNodes[0]||null),K===N?Ot.call(r,H?"html":"body")[0]:H?r.documentElement:_},at=function(n){return Rt.call(n.ownerDocument||n,n,g.SHOW_ELEMENT|g.SHOW_COMMENT|g.SHOW_TEXT|g.SHOW_PROCESSING_INSTRUCTION|g.SHOW_CDATA_SECTION,null)},Re=function(n){return n instanceof x&&(typeof n.nodeName!="string"||typeof n.textContent!="string"||typeof n.removeChild!="function"||!(n.attributes instanceof T)||typeof n.removeAttribute!="function"||typeof n.setAttribute!="function"||typeof n.namespaceURI!="string"||typeof n.insertBefore!="function"||typeof n.hasChildNodes!="function")},rt=function(n){return typeof u=="function"&&n instanceof u};function B(h,n,r){ge(h,d=>{d.call(e,n,r,X)})}const lt=function(n){let r=null;if(B(S.beforeSanitizeElements,n,null),Re(n))return O(n),!0;const d=v(n.nodeName);if(B(S.uponSanitizeElement,n,{tagName:d,allowedTags:y}),ce&&n.hasChildNodes()&&!rt(n.firstElementChild)&&M(/<[/\w!]/g,n.innerHTML)&&M(/<[/\w!]/g,n.textContent)||n.nodeType===ae.progressingInstruction||ce&&n.nodeType===ae.comment&&M(/<[/\w]/g,n.data))return O(n),!0;if(!(z.tagCheck instanceof Function&&z.tagCheck(d))&&(!y[d]||Q[d])){if(!Q[d]&&dt(d)&&(b.tagNameCheck instanceof RegExp&&M(b.tagNameCheck,d)||b.tagNameCheck instanceof Function&&b.tagNameCheck(d)))return!1;if(Me&&!Y[d]){const f=le(n)||n.parentNode,_=xt(n)||n.childNodes;if(_&&f){const E=_.length;for(let I=E-1;I>=0;--I){const P=wt(_[I],!0);P.__removalCount=(n.__removalCount||0)+1,f.insertBefore(P,It(n))}}}return O(n),!0}return n instanceof p&&!Yt(n)||(d==="noscript"||d==="noembed"||d==="noframes")&&M(/<\/no(script|embed|frames)/i,n.innerHTML)?(O(n),!0):(W&&n.nodeType===ae.text&&(r=n.textContent,ge([ve,Te,ke],f=>{r=ne(r,f," ")}),n.textContent!==r&&(ie(e.removed,{element:n.cloneNode()}),n.textContent=r)),B(S.afterSanitizeElements,n,null),!1)},ct=function(n,r,d){if(je&&(r==="id"||r==="name")&&(d in t||d in Gt))return!1;if(!(_e&&!Le[r]&&M(Bt,r))){if(!(Ke&&M(Pt,r))){if(!(z.attributeCheck instanceof Function&&z.attributeCheck(r,n))){if(!k[r]||Le[r]){if(!(dt(n)&&(b.tagNameCheck instanceof RegExp&&M(b.tagNameCheck,n)||b.tagNameCheck instanceof Function&&b.tagNameCheck(n))&&(b.attributeNameCheck instanceof RegExp&&M(b.attributeNameCheck,r)||b.attributeNameCheck instanceof Function&&b.attributeNameCheck(r,n))||r==="is"&&b.allowCustomizedBuiltInElements&&(b.tagNameCheck instanceof RegExp&&M(b.tagNameCheck,d)||b.tagNameCheck instanceof Function&&b.tagNameCheck(d))))return!1}else if(!we[r]){if(!M($e,ne(d,We,""))){if(!((r==="src"||r==="xlink:href"||r==="href")&&n!=="script"&&ni(d,"data:")===0&&Qe[n])){if(!(Xe&&!M(Ut,ne(d,We,"")))){if(d)return!1}}}}}}}return!0},dt=function(n){return n!=="annotation-xml"&&Ne(n,Ht)},ht=function(n){B(S.beforeSanitizeAttributes,n,null);const{attributes:r}=n;if(!r||Re(n))return;const d={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:k,forceKeepAttr:void 0};let f=r.length;for(;f--;){const _=r[f],{name:E,namespaceURI:I,value:P}=_,V=v(E),De=P;let L=E==="value"?De:si(De);if(d.attrName=V,d.attrValue=L,d.keepAttr=!0,d.forceKeepAttr=void 0,B(S.uponSanitizeAttribute,n,d),L=d.attrValue,Je&&(V==="id"||V==="name")&&(F(E,n),L=Ft+L),ce&&M(/((--!?|])>)|<\/(style|title|textarea)/i,L)){F(E,n);continue}if(V==="attributename"&&Ne(L,"href")){F(E,n);continue}if(d.forceKeepAttr)continue;if(!d.keepAttr){F(E,n);continue}if(!Ve&&M(/\/>/i,L)){F(E,n);continue}W&&ge([ve,Te,ke],mt=>{L=ne(L,mt," ")});const ut=v(n.nodeName);if(!ct(ut,V,L)){F(E,n);continue}if(A&&typeof q=="object"&&typeof q.getAttributeType=="function"&&!I)switch(q.getAttributeType(ut,V)){case"TrustedHTML":{L=A.createHTML(L);break}case"TrustedScriptURL":{L=A.createScriptURL(L);break}}if(L!==De)try{I?n.setAttributeNS(I,E,L):n.setAttribute(E,L),Re(n)?O(n):ft(e.removed)}catch{F(E,n)}}B(S.afterSanitizeAttributes,n,null)},Kt=function h(n){let r=null;const d=at(n);for(B(S.beforeSanitizeShadowDOM,n,null);r=d.nextNode();)B(S.uponSanitizeShadowNode,r,null),lt(r),ht(r),r.content instanceof o&&h(r.content);B(S.afterSanitizeShadowDOM,n,null)};return e.sanitize=function(h){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=null,d=null,f=null,_=null;if(Ce=!h,Ce&&(h="<!-->"),typeof h!="string"&&!rt(h))if(typeof h.toString=="function"){if(h=h.toString(),typeof h!="string")throw se("dirty is not a string, aborting")}else throw se("toString is not a function");if(!e.isSupported)return h;if(Ae||xe(n),e.removed=[],typeof h=="string"&&(ee=!1),ee){if(h.nodeName){const P=v(h.nodeName);if(!y[P]||Q[P])throw se("root node is forbidden and cannot be sanitized in-place")}}else if(h instanceof u)r=ot("<!---->"),d=r.ownerDocument.importNode(h,!0),d.nodeType===ae.element&&d.nodeName==="BODY"||d.nodeName==="HTML"?r=d:r.appendChild(d);else{if(!$&&!W&&!H&&h.indexOf("<")===-1)return A&&he?A.createHTML(h):h;if(r=ot(h),!r)return $?null:he?Z:""}r&&Se&&O(r.firstChild);const E=at(ee?h:r);for(;f=E.nextNode();)lt(f),ht(f),f.content instanceof o&&Kt(f.content);if(ee)return h;if($){if(de)for(_=Dt.call(r.ownerDocument);r.firstChild;)_.appendChild(r.firstChild);else _=r;return(k.shadowroot||k.shadowrootmode)&&(_=Nt.call(i,_,!0)),_}let I=H?r.outerHTML:r.innerHTML;return H&&y["!doctype"]&&r.ownerDocument&&r.ownerDocument.doctype&&r.ownerDocument.doctype.name&&M(St,r.ownerDocument.doctype.name)&&(I="<!DOCTYPE "+r.ownerDocument.doctype.name+`>
`+I),W&&ge([ve,Te,ke],P=>{I=ne(I,P," ")}),A&&he?A.createHTML(I):I},e.setConfig=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};xe(h),Ae=!0},e.clearConfig=function(){X=null,Ae=!1},e.isValidAttribute=function(h,n,r){X||xe({});const d=v(h),f=v(n);return ct(d,f,r)},e.addHook=function(h,n){typeof n=="function"&&ie(S[h],n)},e.removeHook=function(h,n){if(n!==void 0){const r=ti(S[h],n);return r===-1?void 0:ii(S[h],r,1)[0]}return ft(S[h])},e.removeHooks=function(h){S[h]=[]},e.removeAllHooks=function(){S=Tt()},e}var kt=Mt();class re{static clean(e){return kt.sanitize(e,{ALLOWED_TAGS:["b","i","u","a","br","span","code","sup","sub","strong","em"],ALLOWED_ATTR:["href","target","class","data-id"]})}static cleanBlock(e){return kt.sanitize(e,{ALLOWED_TAGS:["b","i","u","a","br","span","code","sup","sub","strong","em","p","h1","h2","h3","h4","h5","h6","ul","ol","li","blockquote","img","table","tr","td","th","div"],ALLOWED_ATTR:["href","target","class","src","alt","data-id"]})}}class yi{constructor(e,t,i){a(this,"id");a(this,"type","paragraph");a(this,"element");a(this,"editor");console.log("Paragraph constructor data:",JSON.stringify(t)),this.id=e,this.editor=i,this.element=document.createElement("div"),this.element.classList.add("ce-block"),this.element.dataset.id=e;const s=document.createElement("div");s.classList.add("ce-paragraph"),s.contentEditable="true",s.innerHTML=re.clean(t.text||""),s.setAttribute("data-placeholder",this.editor.t("ui.placeholder")),s.addEventListener("keydown",o=>{o.key==="Enter"&&!o.shiftKey&&(o.preventDefault(),this.editor.blockManager.addBlock("paragraph",{},!0,this.id))}),this.element.appendChild(s)}render(){return this.element}save(){const e=this.element.querySelector(".ce-paragraph");return{id:this.id,type:this.type,content:{text:e?e.innerHTML:""}}}focus(){const e=this.element.querySelector(".ce-paragraph");e&&e.focus()}}class vi{constructor(e,t,i){a(this,"id");a(this,"type","header");a(this,"element");a(this,"editor");a(this,"level");this.id=e,this.editor=i,this.level=t.level||1,this.element=document.createElement("div"),this.element.classList.add("ce-block"),this.element.dataset.id=e;const s=document.createElement(`h${this.level}`);s.classList.add("ce-header"),s.contentEditable="true",s.innerHTML=re.clean(t.text||""),s.dataset.placeholder=`Heading ${this.level}`,s.addEventListener("keydown",o=>{o.key==="Enter"&&!o.shiftKey&&(o.preventDefault(),this.editor.blockManager.addBlock("paragraph",{},!0,this.id))}),this.element.appendChild(s)}render(){return this.element}save(){const e=this.element.querySelector(".ce-header");return{id:this.id,type:this.type,content:{text:e?e.innerHTML:"",level:this.level}}}focus(){const e=this.element.querySelector(".ce-header");e&&e.focus()}}class Ti{constructor(e,t,i){a(this,"id");a(this,"type","list");a(this,"element");a(this,"editor");a(this,"style");a(this,"listElement");this.id=e,this.editor=i,this.style=t.style==="ordered"?"ordered":"unordered",this.element=document.createElement("div"),this.element.classList.add("ce-block"),this.element.dataset.id=e;const s=t.items||[""];this.listElement=document.createElement(this.style==="ordered"?"ol":"ul"),this.listElement.classList.add("ce-list"),s.forEach(o=>{this.addListItem(o)}),this.element.appendChild(this.listElement)}addListItem(e="",t=!1){const i=document.createElement("li");i.classList.add("ce-list-item"),i.contentEditable="true",i.innerHTML=e,this.attachEvents(i),this.listElement.appendChild(i),t&&i.focus()}attachEvents(e){e.addEventListener("keydown",t=>{if(t.key==="Enter"&&!t.shiftKey)if(t.preventDefault(),e.textContent==="")if(this.listElement.children.length===1)this.editor.blockManager.replaceBlock(this.id,"paragraph");else{e.remove();const s=this.editor.blockManager.addBlock("paragraph",{},!0,this.id);s&&s.focus()}else this.addListItem("",!0);else if(t.key==="Backspace"&&e.textContent===""){t.preventDefault();const i=e.previousElementSibling;if(i){e.remove();const s=document.createRange();s.selectNodeContents(i),s.collapse(!1);const o=window.getSelection();o==null||o.removeAllRanges(),o==null||o.addRange(s)}else this.listElement.children.length===1&&this.editor.blockManager.replaceBlock(this.id,"paragraph")}})}render(){return this.element}save(){const e=Array.from(this.listElement.querySelectorAll(".ce-list-item")).map(t=>t.innerHTML);return{id:this.id,type:this.type,content:{style:this.style,items:e}}}focus(){const e=this.listElement.querySelector(".ce-list-item");e&&e.focus()}}class ki{constructor(e,t,i){a(this,"id");a(this,"type","quote");a(this,"element");a(this,"editor");this.id=e,this.editor=i,this.element=document.createElement("div"),this.element.classList.add("ce-block"),this.element.dataset.id=e;const s=document.createElement("blockquote");s.classList.add("ce-quote"),s.contentEditable="true",s.innerHTML=re.clean(t.text||""),s.dataset.placeholder="Enter a quote...",s.addEventListener("keydown",o=>{o.key==="Enter"&&!o.shiftKey&&(o.preventDefault(),this.editor.blockManager.addBlock("paragraph",{},!0,this.id))}),this.element.appendChild(s)}render(){return this.element}save(){const e=this.element.querySelector(".ce-quote");return{id:this.id,type:this.type,content:{text:e?e.innerHTML:""}}}focus(){const e=this.element.querySelector(".ce-quote");e&&e.focus()}}class Li{constructor(e,t,i){a(this,"id");a(this,"type","image");a(this,"element");a(this,"editor");a(this,"url","");a(this,"caption","");a(this,"loading",!1);this.id=e,this.editor=i,this.url=t.url||"",this.caption=t.caption||"",this.element=document.createElement("div"),this.element.classList.add("ce-block"),this.element.dataset.id=e,this.url?this.renderImage():this.renderInput()}renderInput(){this.element.innerHTML="";const e=document.createElement("div");e.classList.add("ce-image-upload-area"),e.style.border="2px dashed #ddd",e.style.padding="20px",e.style.textAlign="center",e.style.cursor="pointer",e.style.borderRadius="8px",e.style.backgroundColor="#f9f9f9";const t=document.createElement("div");t.innerHTML="ðŸ“ "+(this.editor.t("ui.upload_image")||"Click to Upload or Paste URL");const i=document.createElement("input");i.type="file",i.accept="image/*",i.style.display="none";const s=document.createElement("input");s.type="text",s.placeholder="Or paste image URL...",s.classList.add("ce-image-input"),s.style.marginTop="10px",s.style.width="100%",s.style.padding="8px",e.addEventListener("click",o=>{o.target!==s&&i.click()}),e.addEventListener("dragover",o=>{o.preventDefault(),e.style.borderColor="#3388ff"}),e.addEventListener("dragleave",()=>{e.style.borderColor="#ddd"}),e.addEventListener("drop",o=>{var l;o.preventDefault(),e.style.borderColor="#ddd",(l=o.dataTransfer)!=null&&l.files&&o.dataTransfer.files.length>0&&this.handleUpload(o.dataTransfer.files[0])}),i.addEventListener("change",()=>{i.files&&i.files.length>0&&this.handleUpload(i.files[0])}),s.addEventListener("keydown",o=>{o.key==="Enter"&&(o.preventDefault(),this.url=s.value,this.url&&this.renderImage())}),e.appendChild(t),e.appendChild(i),e.appendChild(s),this.element.appendChild(e)}async handleUpload(e){if(!this.loading){this.loading=!0,this.element.innerHTML='<div class="ce-image-loading">Uploading...</div>';try{let t="";this.editor.config.onImageUpload?t=await this.editor.config.onImageUpload(e):t=await this.mockUpload(e),this.url=t,this.loading=!1,this.renderImage()}catch(t){console.error("Upload failed",t),this.loading=!1,this.renderInput(),alert("Upload failed")}}}mockUpload(e){return new Promise(t=>{const i=new FileReader;i.onload=s=>{setTimeout(()=>{var o;t((o=s.target)==null?void 0:o.result)},1e3)},i.readAsDataURL(e)})}renderImage(){this.element.innerHTML="";const e=document.createElement("div");e.classList.add("ce-image-container");const t=document.createElement("img");t.src=this.url,t.classList.add("ce-image");const i=document.createElement("div");i.contentEditable="true",i.classList.add("ce-image-caption"),i.innerHTML=this.caption,i.dataset.placeholder="Type a caption...",i.addEventListener("keydown",s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),this.editor.blockManager.addBlock("paragraph",{},!0,this.id))}),e.appendChild(t),e.appendChild(i),this.element.appendChild(e)}render(){return this.element}save(){const e=this.element.querySelector(".ce-image-caption");return{id:this.id,type:this.type,content:{url:this.url,caption:e?e.innerHTML:""}}}focus(){const e=this.element.querySelector("input");if(e)e.focus();else{const t=this.element.querySelector(".ce-image-caption");t&&t.focus()}}}class _i{constructor(e,t,i){a(this,"id");a(this,"type","divider");a(this,"element");this.id=e,this.element=document.createElement("div"),this.element.classList.add("ce-block"),this.element.dataset.id=e;const s=document.createElement("hr");s.classList.add("ce-divider"),this.element.contentEditable="false",this.element.addEventListener("click",()=>{this.focus()}),this.element.appendChild(s)}render(){return this.element}save(){return{id:this.id,type:this.type,content:{}}}focus(){this.element.classList.add("ce-block--focused")}}class Ai{constructor(e,t,i){a(this,"id");a(this,"type","code");a(this,"element");this.id=e,this.element=document.createElement("div"),this.element.classList.add("ce-block"),this.element.dataset.id=e;const s=document.createElement("pre");s.classList.add("ce-code-wrapper");const o=document.createElement("code");o.classList.add("ce-code"),o.contentEditable="true",o.innerHTML=t.code||"",o.spellcheck=!1,o.dataset.placeholder="Type code...",o.addEventListener("keydown",l=>{l.key==="Tab"&&(l.preventDefault(),document.execCommand("insertText",!1,"  ")),l.key==="Enter"&&l.stopPropagation()}),o.addEventListener("paste",l=>{var p;l.preventDefault();const u=((p=l.clipboardData)==null?void 0:p.getData("text/plain"))||"";document.execCommand("insertText",!1,u)}),s.appendChild(o),this.element.appendChild(s)}render(){return this.element}save(){const e=this.element.querySelector(".ce-code");return{id:this.id,type:this.type,content:{code:e?e.innerHTML:""}}}focus(){const e=this.element.querySelector(".ce-code");e&&e.focus()}}class Si{constructor(e,t,i){a(this,"id");a(this,"type","table");a(this,"element");a(this,"editor");a(this,"table");a(this,"rows");a(this,"cols");var p;this.id=e,this.editor=i,this.element=document.createElement("div"),this.element.classList.add("ce-block"),this.element.dataset.id=e;const s=t.content||[];this.rows=s.length>0?s.length:3,this.cols=((p=s[0])==null?void 0:p.length)>0?s[0].length:2,this.table=document.createElement("table"),this.table.classList.add("ce-table"),s.length>0?this.renderFromData(s):this.initTable(this.rows,this.cols);const o=document.createElement("div");o.classList.add("ce-table-controls");const l=document.createElement("button");l.textContent="+ Row",l.onclick=()=>this.addRow();const u=document.createElement("button");u.textContent="+ Col",u.onclick=()=>this.addCol(),o.appendChild(l),o.appendChild(u),this.element.appendChild(this.table),this.element.appendChild(o)}initTable(e,t){this.table.innerHTML="";for(let i=0;i<e;i++){const s=document.createElement("tr");for(let o=0;o<t;o++){const l=document.createElement("td");l.contentEditable="true",l.classList.add("ce-table-cell"),s.appendChild(l)}this.table.appendChild(s)}}renderFromData(e){this.table.innerHTML="",e.forEach(t=>{const i=document.createElement("tr");t.forEach(s=>{const o=document.createElement("td");o.contentEditable="true",o.classList.add("ce-table-cell"),o.innerHTML=re.clean(s),i.appendChild(o)}),this.table.appendChild(i)})}addRow(){const e=document.createElement("tr");for(let t=0;t<this.cols;t++){const i=document.createElement("td");i.contentEditable="true",i.classList.add("ce-table-cell"),e.appendChild(i)}this.table.appendChild(e),this.rows++,this.editor.emit("change")}addCol(){this.table.querySelectorAll("tr").forEach(t=>{const i=document.createElement("td");i.contentEditable="true",i.classList.add("ce-table-cell"),t.appendChild(i)}),this.cols++,this.editor.emit("change")}render(){return this.element}save(){const e=[];return this.table.querySelectorAll("tr").forEach(i=>{const s=[];i.querySelectorAll("td").forEach(o=>{s.push(o.innerHTML)}),e.push(s)}),{id:this.id,type:this.type,content:{content:e}}}focus(){const e=this.table.querySelector("td");e&&e.focus()}}class Mi{constructor(e,t,i){a(this,"id");a(this,"type","video");a(this,"element");a(this,"editor");a(this,"url","");a(this,"caption","");this.id=e,this.editor=i,this.url=t.url||"",this.caption=t.caption||"",this.element=document.createElement("div"),this.element.classList.add("ce-block"),this.element.dataset.id=e,this.url?this.renderVideo():this.renderInput()}renderInput(){this.element.innerHTML="";const e=document.createElement("div");e.classList.add("ce-video-input-wrapper");const t=document.createElement("input");t.type="text",t.placeholder="Paste YouTube/Vimeo URL...",t.classList.add("ce-video-input"),t.addEventListener("keydown",i=>{i.key==="Enter"&&(i.preventDefault(),this.url=t.value,this.url&&this.renderVideo())}),e.appendChild(t),this.element.appendChild(e)}renderVideo(){this.element.innerHTML="";const e=document.createElement("div");e.classList.add("ce-video-container");const t=document.createElement("iframe");t.src=this.getEmbedUrl(this.url),t.width="100%",t.height="315",t.frameBorder="0",t.allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",t.allowFullscreen=!0,t.classList.add("ce-video");const i=document.createElement("div");i.contentEditable="true",i.classList.add("ce-video-caption"),i.innerHTML=this.caption,i.dataset.placeholder="Type a caption...",i.addEventListener("keydown",s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),this.editor.blockManager.addBlock("paragraph",{},!0,this.id))}),e.appendChild(t),e.appendChild(i),this.element.appendChild(e)}getEmbedUrl(e){const t=/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/,i=e.match(t);if(i)return`https://www.youtube.com/embed/${i[1]}`;const s=/vimeo\.com\/(\d+)/,o=e.match(s);return o?`https://player.vimeo.com/video/${o[1]}`:e}render(){return this.element}save(){const e=this.element.querySelector(".ce-video-caption");return{id:this.id,type:this.type,content:{url:this.url,caption:e?e.innerHTML:""}}}focus(){const e=this.element.querySelector("input");if(e)e.focus();else{const t=this.element.querySelector(".ce-video-caption");t&&t.focus()}}}class wi{constructor(e,t,i){a(this,"id");a(this,"type","checklist");a(this,"element");a(this,"editor");a(this,"container");this.id=e,this.editor=i,this.element=document.createElement("div"),this.element.classList.add("ce-block"),this.element.dataset.id=e,this.container=document.createElement("div"),this.container.classList.add("ce-checklist"),(t.items||[{text:"",checked:!1}]).forEach(o=>{this.addItem(o.text,o.checked)}),this.element.appendChild(this.container)}addItem(e="",t=!1,i=!1){const s=document.createElement("div");s.classList.add("ce-checklist-item");const o=document.createElement("span");o.classList.add("ce-checklist-checkbox"),t&&o.classList.add("ce-checklist-checked"),o.addEventListener("click",()=>{o.classList.toggle("ce-checklist-checked")});const l=document.createElement("div");l.classList.add("ce-checklist-text"),l.contentEditable="true",l.innerHTML=e,this.attachEvents(l,s),s.appendChild(o),s.appendChild(l),this.container.appendChild(s),i&&l.focus()}attachEvents(e,t){e.addEventListener("keydown",i=>{if(i.key==="Enter"&&!i.shiftKey)i.preventDefault(),this.addItem("",!1,!0);else if(i.key==="Backspace"&&e.textContent===""){i.preventDefault();const s=t.previousElementSibling;if(s){t.remove();const o=s.querySelector(".ce-checklist-text");if(o){const l=document.createRange();l.selectNodeContents(o),l.collapse(!1);const u=window.getSelection();u==null||u.removeAllRanges(),u==null||u.addRange(l)}}else this.container.children.length===1&&this.editor.blockManager.replaceBlock(this.id,"paragraph")}})}render(){return this.element}save(){const e=[];return this.container.querySelectorAll(".ce-checklist-item").forEach(i=>{const s=i.querySelector(".ce-checklist-checkbox"),o=i.querySelector(".ce-checklist-text");e.push({text:o?o.innerHTML:"",checked:s?s.classList.contains("ce-checklist-checked"):!1})}),{id:this.id,type:this.type,content:{items:e}}}focus(){const e=this.container.querySelector(".ce-checklist-text");e&&e.focus()}}class Ci{constructor(e){a(this,"editor");a(this,"blocks",[]);a(this,"registry",new Map);this.editor=e,this.register("paragraph",yi),this.register("header",vi),this.register("list",Ti),this.register("quote",ki),this.register("image",Li),this.register("divider",_i),this.register("code",Ai),this.register("table",Si),this.register("video",Mi),this.register("checklist",wi)}register(e,t){this.registry.set(e,t)}addBlock(e,t={},i=!0,s,o){const l=this.registry.get(e);if(!l)return console.error(`Block type ${e} not registered`),null;const u=o||crypto.randomUUID(),p=new l(u,t,this.editor);if(s){const g=this.blocks.findIndex(T=>T.id===s);if(g!==-1){this.blocks.splice(g+1,0,p);const T=this.blocks[g];this.editor.renderer.insertBlockAfter(T,p)}else this.blocks.push(p),this.editor.renderer.appendBlock(p)}else this.blocks.push(p),this.editor.renderer.appendBlock(p);return i&&p.focus(),this.editor.emit("change"),this.editor.emit("block:add",p.save()),p}replaceBlock(e,t,i={}){const s=this.blocks.findIndex(p=>p.id===e);if(s===-1)return console.error(`Block with id ${e} not found`),null;const o=this.registry.get(t);if(!o)return console.error(`Block type ${t} not registered`),null;const l=this.blocks[s],u=new o(e,i,this.editor);return this.blocks[s]=u,this.editor.renderer.replaceBlock(l,u),u.focus(),this.editor.emit("change"),this.editor.emit("block:change",{id:e,content:u.save().content}),u}getBlockById(e){return this.blocks.find(t=>t.id===e)}getBlockIndex(e){return this.blocks.findIndex(t=>t.id===e)}getBlockByIndex(e){return this.blocks[e]}renderBlocks(e){console.log("BlockManager: rendering blocks",e.length),this.editor.renderer.clear(),this.blocks=[],e.forEach(t=>{this.addBlock(t.type,t.content,!1,void 0,t.id)||console.error("Failed to add block",t.type)}),console.log("BlockManager: blocks after render",this.blocks.length)}moveBlock(e,t){const i=this.blocks.findIndex(o=>o.id===e),s=this.blocks.findIndex(o=>o.id===t);if(i!==-1&&s!==-1){const[o]=this.blocks.splice(i,1);let l=this.blocks.findIndex(u=>u.id===t);i<s&&(l=l+1),this.blocks.splice(l,0,o),this.renderBlocks(this.save()),this.editor.emit("change"),this.editor.emit("block:move",{id:e,index:l})}}removeBlock(e){const t=this.blocks.findIndex(i=>i.id===e);t!==-1&&(this.blocks.splice(t,1),this.renderBlocks(this.save()),this.editor.emit("change"),this.editor.emit("block:remove",{id:e}))}save(){return this.blocks.map(e=>e.save())}}class Ii{constructor(e){a(this,"editor");a(this,"container");this.editor=e,this.container=document.createElement("div"),this.container.classList.add("editron-wrapper"),this.editor.holder.appendChild(this.container)}appendBlock(e){const t=this.createBlockWrapper(e);this.container.appendChild(t)}replaceBlock(e,t){const i=this.container.querySelector(`[data-block-id="${e.id}"]`);if(i){const s=this.createBlockWrapper(t);this.container.replaceChild(s,i)}else console.error("Renderer: Could not find block to replace",e.id)}insertBlockAfter(e,t){const i=this.container.querySelector(`[data-block-id="${e.id}"]`),s=this.createBlockWrapper(t);i&&i.nextSibling?this.container.insertBefore(s,i.nextSibling):this.container.appendChild(s)}createBlockWrapper(e){const t=document.createElement("div");t.classList.add("ce-block-wrapper"),t.dataset.blockId=e.id,t.draggable=!0;const i=document.createElement("div");i.classList.add("ce-drag-handle"),i.contentEditable="false",i.innerHTML="â‹®â‹®";const s=e.render();s.classList.add("ce-block-content");const o=document.createElement("div");return o.classList.add("ce-delete-btn"),o.innerHTML="Ã—",o.title="Delete block",o.addEventListener("click",()=>{confirm("Delete this block?")&&this.editor.blockManager.removeBlock(e.id)}),t.appendChild(i),t.appendChild(s),t.appendChild(o),this.attachDragEvents(t),t}attachDragEvents(e){e.addEventListener("dragstart",t=>{var i;(i=t.dataTransfer)==null||i.setData("text/plain",e.dataset.blockId||""),e.classList.add("ce-dragging"),setTimeout(()=>e.classList.add("ce-dragging-ghost"),0)}),e.addEventListener("dragend",()=>{e.classList.remove("ce-dragging","ce-dragging-ghost"),this.container.querySelectorAll(".ce-drag-over").forEach(t=>t.classList.remove("ce-drag-over"))}),e.addEventListener("dragover",t=>{t.preventDefault(),this.container.querySelector(".ce-dragging")!==e&&e.classList.add("ce-drag-over")}),e.addEventListener("dragleave",()=>{e.classList.remove("ce-drag-over")}),e.addEventListener("drop",t=>{var o;t.preventDefault(),e.classList.remove("ce-drag-over");const i=(o=t.dataTransfer)==null?void 0:o.getData("text/plain"),s=e.dataset.blockId;i&&s&&i!==s&&this.editor.blockManager.moveBlock(i,s)})}clear(){this.container.innerHTML=""}}class xi{constructor(e){a(this,"editor");this.editor=e,this.editor.holder.addEventListener("paste",t=>this.handlePaste(t))}handlePaste(e){var s,o;if(e.target.tagName==="INPUT")return;e.preventDefault();const t=(s=e.clipboardData)==null?void 0:s.getData("text/html"),i=(o=e.clipboardData)==null?void 0:o.getData("text/plain");t?this.processHTML(re.cleanBlock(t)):i&&this.processText(i)}processText(e){e.split(/\n\s*\n/).forEach(i=>{i.trim()&&this.editor.blockManager.addBlock("paragraph",{text:i.trim()})})}processHTML(e){const i=new DOMParser().parseFromString(e,"text/html");Array.from(i.body.childNodes).forEach(o=>{var l,u,p;if(o.nodeType===Node.ELEMENT_NODE){const g=o,T=g.tagName.toLowerCase();if(["p","div"].includes(T))(l=g.textContent)!=null&&l.trim()&&this.editor.blockManager.addBlock("paragraph",{text:g.innerHTML});else if(/^h[1-6]$/.test(T)){const x=parseInt(T.replace("h",""));this.editor.blockManager.addBlock("header",{text:g.innerHTML,level:x})}else if(T==="ul"||T==="ol"){const x=Array.from(g.querySelectorAll("li")).map(j=>j.innerHTML);this.editor.blockManager.addBlock("list",{style:T==="ol"?"ordered":"unordered",items:x})}else if(T==="blockquote")this.editor.blockManager.addBlock("quote",{text:g.innerHTML});else if(T==="img"){const x=g;x.src&&this.editor.blockManager.addBlock("image",{url:x.src,caption:x.alt})}else if(T==="pre")this.editor.blockManager.addBlock("code",{code:g.textContent||""});else if(T==="hr")this.editor.blockManager.addBlock("divider");else if(T==="table"){const x=Array.from(g.querySelectorAll("tr")).map(j=>Array.from(j.querySelectorAll("td, th")).map(q=>q.innerHTML));x.length>0&&this.editor.blockManager.addBlock("table",{content:x})}else(u=g.textContent)!=null&&u.trim()&&this.editor.blockManager.addBlock("paragraph",{text:g.textContent})}else o.nodeType===Node.TEXT_NODE&&(p=o.textContent)!=null&&p.trim()&&this.editor.blockManager.addBlock("paragraph",{text:o.textContent.trim()})})}}class Ri{constructor(e){a(this,"editor");a(this,"stack",[]);a(this,"position",-1);a(this,"limit",50);a(this,"isUndoing",!1);this.editor=e}pushState(){if(this.isUndoing)return;const e=JSON.stringify(this.editor.blockManager.save());this.position>=0&&this.stack[this.position]===e||(this.position<this.stack.length-1&&(this.stack=this.stack.slice(0,this.position+1)),this.stack.push(e),this.stack.length>this.limit?this.stack.shift():this.position++)}undo(){if(this.position>0){this.isUndoing=!0,this.position--;const e=JSON.parse(this.stack[this.position]);this.editor.blockManager.renderBlocks(e),this.isUndoing=!1}}redo(){if(this.position<this.stack.length-1){this.isUndoing=!0,this.position++;const e=JSON.parse(this.stack[this.position]);this.editor.blockManager.renderBlocks(e),this.isUndoing=!1}}}class Di{constructor(e){a(this,"locale","en");a(this,"messages",{});e!=null&&e.locale&&(this.locale=e.locale),e!=null&&e.messages&&(this.messages=e.messages)}t(e){const t=e.split(".");let i=this.messages[this.locale]||{};for(const s of t){if(i[s]===void 0){if(this.locale!=="en"){let o=this.messages.en||{};for(const l of t){if(o[l]===void 0)return e;o=o[l]}return o}return e}i=i[s]}return i}isRTL(){return["fa","ar","he"].includes(this.locale)}setLocale(e){this.locale=e}}const Oi={slash_menu:{heading1:"Heading 1",heading2:"Heading 2",heading3:"Heading 3",paragraph:"Paragraph",list_unordered:"Bulleted List",list_ordered:"Ordered List",checklist:"Checklist",quote:"Quote",image:"Image",divider:"Divider",code:"Code Block",table:"Table",video:"Video Embed",ai_generate:"âœ¨ Generate Text"},toolbar:{bold:"Bold",italic:"Italic",underline:"Underline",link:"Link",ai_assist:"AI Assist"},ui:{placeholder:"Start writing...",delete_block:"Delete"}},Ni={slash_menu:{heading1:"Ø¹Ù†ÙˆØ§Ù† Û±",heading2:"Ø¹Ù†ÙˆØ§Ù† Û²",heading3:"Ø¹Ù†ÙˆØ§Ù† Û³",paragraph:"Ù¾Ø§Ø±Ø§Ú¯Ø±Ø§Ù",list_unordered:"Ù„ÛŒØ³Øª Ù†Ø´Ø§Ù†Ù‡â€ŒØ¯Ø§Ø±",list_ordered:"Ù„ÛŒØ³Øª Ø¹Ø¯Ø¯ÛŒ",checklist:"Ú†Ú©â€ŒÙ„ÛŒØ³Øª",quote:"Ù†Ù‚Ù„ Ù‚ÙˆÙ„",image:"ØªØµÙˆÛŒØ±",divider:"Ø®Ø· Ø¬Ø¯Ø§Ú©Ù†Ù†Ø¯Ù‡",code:"Ú©Ø¯",table:"Ø¬Ø¯ÙˆÙ„",video:"ÙˆÛŒØ¯ÛŒÙˆ",ai_generate:"âœ¨ ØªÙˆÙ„ÛŒØ¯ Ù…ØªÙ† Ù‡ÙˆØ´Ù…Ù†Ø¯"},toolbar:{bold:"Ø¶Ø®ÛŒÙ…",italic:"Ú©Ø¬",underline:"Ø²ÛŒØ±Ø®Ø·",link:"Ù„ÛŒÙ†Ú©",ai_assist:"Ø¯Ø³ØªÛŒØ§Ø± Ù‡ÙˆØ´Ù…Ù†Ø¯"},ui:{placeholder:"Ø´Ø±ÙˆØ¹ Ø¨Ù‡ Ù†ÙˆØ´ØªÙ† Ú©Ù†ÛŒØ¯...",delete_block:"Ø­Ø°Ù"}};class Bi extends jt{constructor(t){super();a(this,"config");a(this,"pluginManager");a(this,"blockManager");a(this,"renderer");a(this,"historyManager");a(this,"holder");a(this,"i18n");if(this.config=t,this.i18n=new Di({locale:t.locale||"en",messages:{en:Oi,fa:Ni,...t.i18n}}),typeof t.holder=="string"){const i=document.getElementById(t.holder);if(!i)throw new Error(`Element with id ${t.holder} not found`);this.holder=i}else this.holder=t.holder;this.holder.classList.add("editron-editor"),this.i18n.isRTL()&&(this.holder.setAttribute("dir","rtl"),this.holder.classList.add("editron-rtl")),this.holder.addEventListener("input",i=>{this.emit("change");const o=i.target.closest(".ce-block-wrapper");if(o&&o.dataset.blockId){const l=o.dataset.blockId,u=this.blockManager.getBlockById(l);u&&this.emit("block:change",{id:l,content:u.save().content})}}),this.pluginManager=new Jt(this),this.blockManager=new Ci(this),this.renderer=new Ii(this),this.historyManager=new Ri(this),new xi(this),this.setupShortcuts()}setupShortcuts(){document.addEventListener("keydown",t=>{(t.ctrlKey||t.metaKey)&&t.key==="z"&&(t.preventDefault(),t.shiftKey?this.historyManager.redo():this.historyManager.undo()),(t.ctrlKey||t.metaKey)&&t.key==="y"&&!t.shiftKey&&(t.preventDefault(),this.historyManager.redo())})}init(){if(this.emit("init"),this.blockManager.save().length>0){this.emit("ready");return}this.config.data&&this.config.data.length>0?this.blockManager.renderBlocks(this.config.data):this.blockManager.addBlock("paragraph",{},!1),this.emit("ready"),this.historyManager.pushState();let i;this.on("change",()=>{clearTimeout(i),i=window.setTimeout(()=>{this.historyManager.pushState()},500)})}save(){return Promise.resolve(this.blockManager.save())}t(t){return this.i18n.t(t)}}class Pi{constructor(){a(this,"name","toolbar");a(this,"editor",null);a(this,"toolbar");this.toolbar=document.createElement("div"),this.toolbar.classList.add("editron-toolbar")}init(e){this.editor=e,this.renderToolbar(),this.editor.holder.insertBefore(this.toolbar,this.editor.holder.firstChild),document.addEventListener("selectionchange",()=>{this.updateButtonStates()}),this.toolbar.addEventListener("mousedown",t=>{t.preventDefault()}),this.toolbar.addEventListener("click",t=>{const i=t.target.closest(".toolbar-btn");if(i){const s=i.dataset.cmd,o=i.dataset.type;s==="ai"?this.triggerAI():s?(document.execCommand(s,!1),this.updateButtonStates()):o&&this.handleBlockAction(i)}})}renderToolbar(){if(!this.editor)return;const e=t=>this.editor.t(t);this.toolbar.innerHTML=`
        <div class="toolbar-group">
            <button class="toolbar-btn" data-cmd="bold" title="${e("toolbar.bold")}"><b>B</b></button>
            <button class="toolbar-btn" data-cmd="italic" title="${e("toolbar.italic")}"><i>I</i></button>
            <button class="toolbar-btn" data-cmd="underline" title="${e("toolbar.underline")}"><u>U</u></button>
        </div>
        <div class="toolbar-separator"></div>
        <div class="toolbar-group">
            <button class="toolbar-btn" data-type="header" data-level="1" title="${e("slash_menu.heading1")}">H1</button>
            <button class="toolbar-btn" data-type="header" data-level="2" title="${e("slash_menu.heading2")}">H2</button>
            <button class="toolbar-btn" data-type="header" data-level="3" title="${e("slash_menu.heading3")}">H3</button>
            <button class="toolbar-btn" data-type="paragraph" title="${e("slash_menu.paragraph")}">Â¶</button>
        </div>
        <div class="toolbar-separator"></div>
        <div class="toolbar-group">
            <button class="toolbar-btn" data-type="list" data-style="unordered" title="${e("slash_menu.list_unordered")}">â€¢ List</button>
            <button class="toolbar-btn" data-type="list" data-style="ordered" title="${e("slash_menu.list_ordered")}">1. List</button>
            <button class="toolbar-btn" data-type="checklist" title="${e("slash_menu.checklist")}">â˜‘</button>
        </div>
        <div class="toolbar-separator"></div>
        <div class="toolbar-group">
            <button class="toolbar-btn" data-type="quote" title="${e("slash_menu.quote")}">â</button>
            <button class="toolbar-btn" data-type="code" title="${e("slash_menu.code")}">&lt;/&gt;</button>
            <button class="toolbar-btn" data-type="table" title="${e("slash_menu.table")}">â–¦</button>
            <button class="toolbar-btn" data-type="divider" title="${e("slash_menu.divider")}">â€”</button>
        </div>
         <div class="toolbar-separator"></div>
        <div class="toolbar-group">
            <button class="toolbar-btn" data-type="image" title="${e("slash_menu.image")}">ðŸ–¼</button>
            <button class="toolbar-btn" data-type="video" title="${e("slash_menu.video")}">ðŸŽ¥</button>
        </div>
        <div class="toolbar-separator"></div>
        <div class="toolbar-group">
            <button class="toolbar-btn ce-ai-trigger" data-cmd="ai" title="${e("toolbar.ai_assist")}">âœ¨ AI</button>
        </div>
    `}getActiveBlockId(){const e=window.getSelection();if(!e||e.rangeCount===0)return null;const t=e.anchorNode;if(!t)return null;const i=t.nodeType===Node.TEXT_NODE?t.parentElement:t,s=i==null?void 0:i.closest(".ce-block-wrapper");return s&&s.dataset.blockId||null}handleBlockAction(e){if(!this.editor)return;const t=e.dataset.type,i=this.getActiveBlockId(),s=e.dataset.level?parseInt(e.dataset.level):void 0,o=e.dataset.style;if(["header","paragraph","list","checklist","quote","code"].includes(t)&&i){const u=this.editor.blockManager.getBlockById(i);let p="";u&&(p=u.save().content.text||""),this.editor.blockManager.replaceBlock(i,t,{text:p,level:s,style:o,items:[]})}else this.editor.blockManager.addBlock(t,{},!0,i||void 0)}updateButtonStates(){this.toolbar.querySelectorAll(".toolbar-btn[data-cmd]").forEach(t=>{const i=t.dataset.cmd;i&&i!=="ai"&&(document.queryCommandState(i)?t.classList.add("active"):t.classList.remove("active"))})}triggerAI(){if(!this.editor)return;const e=this.editor.pluginManager.get("ai-assistant");if(e){const t=this.toolbar.getBoundingClientRect(),i=window.getSelection();if(i&&i.rangeCount>0){const o=i.getRangeAt(0).getBoundingClientRect();if(o.width>0&&o.height>0){e.show(o);return}}e.show(t)}}destroy(){this.toolbar.remove()}}class Ui{constructor(){a(this,"name","slash-menu");a(this,"editor",null);a(this,"menu");a(this,"activeBlockId",null);a(this,"isOpen",!1);a(this,"selectedIndex",0);this.menu=document.createElement("div"),this.menu.classList.add("editron-slash-menu"),this.menu.style.display="none",document.body.appendChild(this.menu)}init(e){this.editor=e,this.renderMenu(),this.editor.holder.addEventListener("keyup",t=>{this.handleKeyUp(t)}),this.editor.holder.addEventListener("keydown",t=>{this.isOpen&&(t.key==="ArrowUp"||t.key==="ArrowDown"||t.key==="Enter")&&(t.preventDefault(),this.handleNavigation(t))}),this.menu.addEventListener("click",t=>{t.stopPropagation();const i=t.target;if(i.classList.contains("menu-item")&&this.activeBlockId&&this.editor){const s=i.dataset.type,o=i.dataset.level?parseInt(i.dataset.level):void 0;if(s==="ai-generate"){this.triggerAIGenerate(i),this.close();return}if(s){const l=i.dataset.style;this.editor.blockManager.replaceBlock(this.activeBlockId,s,{text:"",level:o,style:l})}this.close()}}),document.addEventListener("click",t=>{this.menu.contains(t.target)||this.close()})}renderMenu(){if(!this.editor)return;const e=t=>this.editor.t(t);this.menu.innerHTML=`
        <div class="menu-item" data-type="header" data-level="1">${e("slash_menu.heading1")}</div>
        <div class="menu-item" data-type="header" data-level="2">${e("slash_menu.heading2")}</div>
        <div class="menu-item" data-type="header" data-level="3">${e("slash_menu.heading3")}</div>
        <div class="menu-item" data-type="paragraph">${e("slash_menu.paragraph")}</div>
        <div class="menu-item" data-type="list" data-style="unordered">${e("slash_menu.list_unordered")}</div>
        <div class="menu-item" data-type="list" data-style="ordered">${e("slash_menu.list_ordered")}</div>
        <div class="menu-item" data-type="checklist">${e("slash_menu.checklist")}</div>
        <div class="menu-item" data-type="quote">${e("slash_menu.quote")}</div>
        <div class="menu-item" data-type="image">${e("slash_menu.image")}</div>
        <div class="menu-item" data-type="divider">${e("slash_menu.divider")}</div>
        <div class="menu-item" data-type="code">${e("slash_menu.code")}</div>
        <div class="menu-item" data-type="table">${e("slash_menu.table")}</div>
        <div class="menu-item" data-type="video">${e("slash_menu.video")}</div>
        <div class="menu-item" data-type="ai-generate">${e("slash_menu.ai_generate")}</div>
      `}handleNavigation(e){const t=this.menu.querySelectorAll(".menu-item");if(t.length!==0){if(e.key==="ArrowUp")this.selectedIndex=(this.selectedIndex-1+t.length)%t.length,this.updateSelection();else if(e.key==="ArrowDown")this.selectedIndex=(this.selectedIndex+1)%t.length,this.updateSelection();else if(e.key==="Enter"){const i=t[this.selectedIndex];i&&i.click()}}}updateSelection(){this.menu.querySelectorAll(".menu-item").forEach((t,i)=>{i===this.selectedIndex?(t.classList.add("selected"),t.scrollIntoView({block:"nearest"})):t.classList.remove("selected")})}handleKeyUp(e){if(!this.editor)return;const t=window.getSelection();if(!t||t.rangeCount===0)return;const s=t.getRangeAt(0).startContainer,o=s.nodeType===Node.TEXT_NODE?s.parentElement.closest(".ce-block"):s.closest(".ce-block");if(o){const l=o.textContent||"";l.trim()==="/"&&!this.isOpen?(this.activeBlockId=o.dataset.id||null,this.open(o)):l.trim()!=="/"&&this.isOpen&&this.close()}}open(e){var i;this.isOpen=!0,this.selectedIndex=0;const t=e.getBoundingClientRect();this.menu.style.display="block",this.menu.style.top=`${t.bottom+window.scrollY}px`,(i=this.editor)!=null&&i.i18n.isRTL()?(this.menu.style.left="auto",this.menu.style.right=`${window.innerWidth-t.right+window.scrollX}px`,this.menu.classList.add("editron-rtl")):(this.menu.style.left=`${t.left+window.scrollX}px`,this.menu.style.right="auto",this.menu.classList.remove("editron-rtl")),this.updateSelection()}triggerAIGenerate(e){if(!this.editor)return;const t=this.editor.pluginManager.get("ai-assistant");if(t&&this.activeBlockId){const i=this.editor.holder.querySelector(`[data-block-id="${this.activeBlockId}"]`);if(i){const s=document.createRange();s.selectNodeContents(i);const o=window.getSelection();o==null||o.removeAllRanges(),o==null||o.addRange(s);const l=e.getBoundingClientRect();t.show(l)}}}close(){this.isOpen=!1,this.menu.style.display="none",this.activeBlockId=null}destroy(){this.menu.remove()}}class Hi{constructor(){a(this,"name","ai-assistant");a(this,"editor",null);a(this,"dialog");this.dialog=document.createElement("div"),this.dialog.classList.add("ce-ai-dialog"),this.dialog.style.display="none",this.dialog.innerHTML=`
        <div class="ce-ai-header">âœ¨ AI Assistant</div>
        <div class="ce-ai-options">
            <button data-action="summarize" aria-label="Summarize text">Summarize</button>
            <button data-action="expand" aria-label="Expand text">Expand</button>
            <button data-action="fix" aria-label="Fix grammar">Fix Grammar</button>
            <button data-action="make-funny" aria-label="Make text funny">Make Funny</button>
        </div>
        <div class="ce-ai-loading" style="display:none;">Thinking...</div>
    `,this.dialog.addEventListener("click",e=>{const t=e.target;t.tagName==="BUTTON"&&t.dataset.action&&this.handleAction(t.dataset.action)}),document.body.appendChild(this.dialog),document.addEventListener("click",e=>{this.dialog.style.display==="block"&&!this.dialog.contains(e.target)&&!e.target.classList.contains("ce-ai-trigger")&&this.close()})}init(e){this.editor=e}show(e){this.dialog.style.display="block",this.dialog.style.top=`${e.bottom+window.scrollY+10}px`,this.dialog.style.left=`${e.left+window.scrollX}px`}close(){this.dialog.style.display="none";const e=this.dialog.querySelector(".ce-ai-loading"),t=this.dialog.querySelector(".ce-ai-options");e&&(e.style.display="none"),t&&(t.style.display="flex")}handleAction(e){const t=window.getSelection();if(!t||t.rangeCount===0)return;const s=t.getRangeAt(0).toString();if(!s)return;const o=this.dialog.querySelector(".ce-ai-loading"),l=this.dialog.querySelector(".ce-ai-options");o.style.display="block",l.style.display="none",setTimeout(()=>{const u=this.mockAIProcess(s,e);this.applyResult(u),this.close()},1e3)}mockAIProcess(e,t){switch(t){case"summarize":return`[Summary: ${e.substring(0,20)}...]`;case"expand":return`${e} And here is some more AI-generated content expanding on the topic to make it look professional and verbose.`;case"fix":return e.charAt(0).toUpperCase()+e.slice(1)+(e.endsWith(".")?"":".");case"make-funny":return`${e} (lol!)`;default:return e}}applyResult(e){document.execCommand("insertText",!1,e),this.editor&&this.editor.emit("change")}}class Fi{constructor(){a(this,"name","autosave");a(this,"editor",null);a(this,"storageKey","editron_autosave_data");a(this,"debounceTimer",null);a(this,"interval",2e3)}init(e){this.editor=e,this.restore(),this.editor.on("change",()=>{this.requestSave()})}requestSave(){this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=window.setTimeout(()=>{this.save()},this.interval)}save(){this.editor&&this.editor.save().then(e=>{localStorage.setItem(this.storageKey,JSON.stringify(e)),console.log("Editron: Data autosaved")})}restore(){const e=localStorage.getItem(this.storageKey);if(e&&this.editor)try{const t=JSON.parse(e);Array.isArray(t)&&t.length>0&&(console.log("Editron: Restoring autosaved data"),this.editor.blockManager.renderBlocks(t))}catch(t){console.error("Editron: Failed to restore autosaved data",t)}}clear(){localStorage.removeItem(this.storageKey),console.log("Editron: Autosave data cleared")}}var Lt;if(typeof window<"u"){const e=new URLSearchParams(window.location.search).get("locale")||"en",t=document.getElementById("editorjs");if(t){const i=new Bi({holder:t,placeholder:e==="fa"?"Ø´Ø±ÙˆØ¹ Ø¨Ù‡ Ù†ÙˆØ´ØªÙ† Ú©Ù†ÛŒØ¯...":"Let`s write an awesome story!",locale:e,data:[]});i.init(),i.pluginManager.register(new Pi),i.pluginManager.register(new Ui),i.pluginManager.register(new Hi),i.pluginManager.register(new Fi),(Lt=document.getElementById("save-btn"))==null||Lt.addEventListener("click",()=>{i.save().then(s=>{console.log("Article data: ",s),alert("Data saved! Check console.")})}),window.editor=i}}
