# مستندات توسعه Editron (فاز ۱: هسته و معماری پایه)

این مستندات مراحل توسعه ویرایشگر متن **Editron** را از صفر تا صد (در فاز اول) شرح می‌دهد. هدف ما ساخت یک ویرایشگر متن مدرن، بلاک‌بیس (Block-based) و قابل توسعه است.

---

## ۱. مقدمه (Introduction)

در دنیای وب مدرن، ویرایشگرهای `contenteditable` ساده دیگر پاسخگو نیستند. ما نیاز به ساختاری داریم که:
1. خروجی JSON تمیز بدهد (نه HTML کثیف).
2. قابل توسعه باشد (پلاگین‌سیستم).
3. پرفورمنس بالایی داشته باشد.

در این فاز، ما **Core Engine** را پیاده‌سازی کردیم.

---

## ۲. ساختار پروژه (Project Structure)

ما از `Vite` و `TypeScript` برای شروع استفاده کردیم تا محیط توسعه سریع و تایپ‌سیف داشته باشیم.

```bash
src/
├── blocks/         # محل قرارگیری بلاک‌ها (پاراگراف، تیتر، تصویر و...)
├── core/           # هسته اصلی ویرایشگر
│   ├── BlockManager.ts  # مدیریت بلاک‌ها (افزودن، حذف، جابجایی)
│   ├── Editron.ts       # کلاس اصلی و نقطه ورود
│   ├── EventEmitter.ts  # سیستم رویدادها (Event Bus)
│   ├── PluginManager.ts # مدیریت پلاگین‌ها
│   └── Renderer.ts      # موتور رندرینگ (تبدیل داده به DOM)
├── types/          # اینترفیس‌ها و تایپ‌های اصلی
└── index.ts        # فایل اجرایی برای دمو
```

---

## ۳. معماری هسته (Core Architecture)

### ۳.۱. کلاس اصلی (Editron Class)
این کلاس به عنوان "مغز" ویرایشگر عمل می‌کند. وظیفه آن هماهنگ‌سازی سایر اجزا است.

```typescript
// src/core/Editron.ts
export class Editron extends EventEmitter {
  constructor(config) {
    // راه‌اندازی سیستم پلاگین، مدیریت بلاک و رندرینگ
    this.pluginManager = new PluginManager(this);
    this.blockManager = new BlockManager(this);
    this.renderer = new Renderer(this);
  }
}
```

### ۳.۲. سیستم رویداد (Event System)
برای اینکه اجزای مختلف (مثلاً UI و Core) بتوانند بدون وابستگی مستقیم با هم صحبت کنند، از الگوی `Observer` استفاده کردیم (`EventEmitter`).

### ۳.۳. مدیریت بلاک‌ها (Block Manager)
برخلاف ویرایشگرهای کلاسیک که یک `div` بزرگ قابل ویرایش هستند، Editron محتوا را به "بلاک" تقسیم می‌کند. هر پاراگراف، عکس یا لیست یک بلاک مستقل است.
`BlockManager` وظیفه دارد این بلاک‌ها را بسازد و مدیریت کند.

---

## ۴. ساخت اولین بلاک: پاراگراف (Paragraph Block)

هر بلاک در Editron باید اینترفیس `IBlock` را پیاده‌سازی کند:

```typescript
export interface IBlock {
  render(): HTMLElement; // ظاهر بلاک را می‌سازد
  save(): BlockData;     // دیتای بلاک را برای ذخیره برمی‌گرداند
}
```

ما یک بلاک ساده `Paragraph` ساختیم که یک `div` با قابلیت `contenteditable` ایجاد می‌کند. همچنین رویداد `Enter` را شنود می‌کند تا وقتی کاربر اینتر زد، یک بلاک جدید ساخته شود (رفتار استاندارد ویرایشگرها).

---

## ۵. نحوه استفاده (Usage)

برای استفاده از این ادیتور در پروژه:

1. یک عنصر در HTML با یک ID بسازید.
2. ادیتور را فراخوانی کنید:

```typescript
const editor = new Editron({
  holder: 'editorjs', // ID عنصر
  data: [] // دیتای اولیه (اختیاری)
});

editor.init();
```

---

## ۶. قدم‌های بعدی (Next Steps)

در فازهای بعدی (۰ تا ۱۰۰) موارد زیر اضافه خواهند شد:
- **UI:** تولبار شناور و منوی تنظیمات بلاک.
- **Plugins:** سیستم پلاگین پیشرفته‌تر برای افزودن ایمج، جدول و...
- **Collaboration:** قابلیت ویرایش همزمان.

این پروژه با رعایت اصول **Clean Architecture** و **Solid Principles** پایه‌ریزی شده است تا برای توسعه‌های بزرگ آینده آماده باشد.
