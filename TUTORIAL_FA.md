# مستندات توسعه Editron (فاز ۱ تا ۱۳)

این مستندات مراحل توسعه ویرایشگر متن **Editron** را شرح می‌دهد.

---

## ۱. مقدمه (Introduction)
Editron یک ویرایشگر متن مدرن و بلاک‌بیس است. تا کنون ۱۳ فاز توسعه تکمیل شده است.

---

## ۲. ساختار پروژه (Project Structure)
```bash
src/
├── blocks/          # بلاک‌ها
├── core/            # هسته اصلی
│   ├── HistoryManager.ts # مدیریت تاریخچه (جدید)
│   ├── ...
├── plugins/         # پلاگین‌ها
├── utils/           # ابزارها
│   ├── Sanitizer.ts # پاکسازی امنیتی (جدید)
│   ├── ...
└── index.ts
```

---

## ۳. قابلیت‌های فاز ۱۳ (جدید)

### ۳.۱. سیستم تاریخچه (Undo/Redo)
قابلیت بازگشت به عقب و جلو (`Ctrl+Z` / `Ctrl+Shift+Z` یا `Ctrl+Y`).
- **مکانیزم:** کلاس `HistoryManager` یک پشته (Stack) از وضعیت‌های JSON کل سند را نگه می‌دارد.
- **ذخیره‌سازی:** با هر تغییر در سند (`change` event)، وضعیت جدید با کمی تاخیر (debounce) ذخیره می‌شود.
- **محدودیت:** به صورت پیش‌فرض ۵۰ تغییر آخر ذخیره می‌شود.

### ۳.۲. امنیت و پاکسازی (Security & Sanitization)
افزودن لایه امنیتی برای جلوگیری از حملات XSS.
- **ابزار:** استفاده از کتابخانه `DOMPurify`.
- **کاربرد:**
  - هنگام رندر کردن بلاک‌های متنی (پاراگراف، تیتر، نقل قول، جدول).
  - هنگام Paste کردن محتوای HTML از منابع خارجی.
- **تگ‌های مجاز:** فقط تگ‌های امن و فرمت‌دهی (مانند `b`, `i`, `a`, `table`, ...) مجاز هستند و اسکریپت‌ها حذف می‌شوند.

---

## ۶. وضعیت فعلی
- ✅ Core Engine & History
- ✅ Security (Sanitizer)
- ✅ All Features & Plugins
- 🏁 **Project Complete (V1.0)**
